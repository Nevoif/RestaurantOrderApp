<Window x:Class="RestaurantApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:RestaurantApp"
        Height="900" Width="1400"
        Background="{StaticResource PrimaryBrush}"
        Foreground="{StaticResource TextBrush}"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource SecondaryBrush}" Padding="15,10" BorderThickness="0,0,0,1" BorderBrush="{StaticResource BorderBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="180"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto" MinWidth="180"/>
                </Grid.ColumnDefinitions>
                
                <!-- Left: Earnings -->
                <Button Grid.Column="0" Command="{Binding EarningsCommand}" 
                        Background="#28a745" Foreground="White"
                        Style="{StaticResource DarkButtonStyle}" 
                        HorizontalAlignment="Left" VerticalAlignment="Center"
                        Padding="15,10" MinWidth="140">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’°" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="22"/>
                        <TextBlock Text="{Binding LocalizedEarningsButton}" VerticalAlignment="Center" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>
                </Button>
                
                <!-- Center: Title -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ´" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding LocalizedTitle}" FontSize="26" FontWeight="Bold" Foreground="{StaticResource AccentBrush}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Right: Settings -->
                <Button Grid.Column="2" Command="{Binding SettingsCommand}" 
                        Style="{StaticResource DarkButtonStyle}" 
                        HorizontalAlignment="Right" Padding="15,5">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âš™ï¸" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="22"/>
                        <TextBlock Text="{Binding LocalizedSettingsButton}" VerticalAlignment="Center" FontSize="16" FontWeight="Bold"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="350"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Tables (2 Column Layout) -->
            <Border Grid.Column="0" Background="{StaticResource SecondaryBrush}" Padding="15" BorderThickness="0,0,1,0" BorderBrush="{StaticResource BorderBrush}">
                <StackPanel>
                    <TextBlock Text="{Binding LocalizedTablesLabel}" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding Tables}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.SelectTableCommand}" 
                                            CommandParameter="{Binding Number}"
                                            Margin="0,0,5,10"
                                            Padding="15,20"
                                            Width="110"
                                            Background="{Binding HasActiveOrder, Converter={StaticResource ActiveOrderConverter}}">
                                        <Button.Style>
                                            <Style TargetType="Button" BasedOn="{StaticResource SecondaryButtonStyle}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                        <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                                        <Setter Property="BorderThickness" Value="3"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <StackPanel>
                                            <TextBlock Text="{Binding DisplayName}" FontWeight="Bold" FontSize="14"/>
                                            <TextBlock Text="{Binding HasActiveOrder, Converter={StaticResource OccupancyConverter}}" FontSize="12" Foreground="{StaticResource LightTextBrush}"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <!-- Middle Panel - Menu Selection -->
            <Border Grid.Column="1" Background="{StaticResource PrimaryBrush}" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TabControl Grid.Row="0" Background="{StaticResource SecondaryBrush}" Foreground="{StaticResource TextBrush}">
                        <!-- Main Foods Tab -->
                        <TabItem Padding="10">
                            <TabItem.Header>
                                <TextBlock Text="{Binding LocalizedMainFoodsTab}"/>
                            </TabItem.Header>
                            <Grid Background="{StaticResource PrimaryBrush}">
                                <ItemsControl ItemsSource="{Binding MainItems}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel Orientation="Horizontal" Background="{StaticResource PrimaryBrush}"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.SelectItemCommand}"
                                                    CommandParameter="{Binding .}"
                                                    Margin="10"
                                                    Padding="15,30"
                                                    MinWidth="150"
                                                    Style="{StaticResource DarkButtonStyle}">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock Text="{Binding Name}" FontWeight="Bold" TextAlignment="Center"/>
                                                    <TextBlock Text="{Binding Price, StringFormat='0.00\u20ba'}" Foreground="{StaticResource LightTextBrush}" TextAlignment="Center"/>
                                                </StackPanel>
                                            </Button>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </TabItem>

                        <!-- Drinks Tab -->
                        <TabItem Padding="10">
                            <TabItem.Header>
                                <TextBlock Text="{Binding LocalizedDrinksTab}"/>
                            </TabItem.Header>
                            <ItemsControl ItemsSource="{Binding DrinkItems}" Background="{StaticResource PrimaryBrush}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.SelectItemCommand}"
                                                CommandParameter="{Binding .}"
                                                Margin="10"
                                                Padding="15,30"
                                                MinWidth="150"
                                                Style="{StaticResource DarkButtonStyle}">
                                            <StackPanel HorizontalAlignment="Center">
                                                <TextBlock Text="{Binding Name}" FontWeight="Bold" TextAlignment="Center"/>
                                                <TextBlock Text="{Binding Price, StringFormat='0.00\u20ba'}" Foreground="{StaticResource LightTextBrush}" TextAlignment="Center"/>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </TabItem>
                    </TabControl>

                    <!-- Toppings Section (Visible for both tabs) -->
                    <Border Grid.Row="1" Background="{StaticResource SecondaryBrush}" Padding="15" Margin="0,15,0,0" 
                            BorderThickness="0,1,0,0" BorderBrush="{StaticResource BorderBrush}"
                            Visibility="{Binding SelectedMenuItem, Converter={StaticResource NullToVisConverter}}">
                        <StackPanel>
                            <TextBlock Text="{Binding LocalizedToppingsLabel}" FontWeight="Bold" FontSize="20" Margin="0,0,0,15" Foreground="White"/>
                            <ItemsControl ItemsSource="{Binding SelectedMenuItem.AvailableToppings}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox Margin="0,8,20,8" FontSize="16" Foreground="White"
                                                  IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                  Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.ToggleToppingCommand}"
                                                  CommandParameter="{Binding .}">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Name}" Margin="0,0,5,0" FontSize="18" Foreground="White"/>
                                                <TextBlock Text="(+" FontSize="18" Foreground="White"/>
                                                <TextBlock Text="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.CurrencySymbol}" FontSize="18" Foreground="White"/>
                                                <TextBlock Text="{Binding Price, StringFormat=0:F2}" FontSize="18" Foreground="White"/>
                                                <TextBlock Text=")" FontSize="18" Foreground="White"/>
                                            </StackPanel>
                                        </CheckBox>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Right Panel - Order Summary -->
            <Border Grid.Column="2" Background="{StaticResource SecondaryBrush}" Padding="15" BorderThickness="1,0,0,0" BorderBrush="{StaticResource BorderBrush}">
                <StackPanel>
                    <!-- Selected Item Info -->
                    <Border Background="{StaticResource PrimaryBrush}" Padding="10" CornerRadius="4" Margin="0,0,0,15">
                        <StackPanel>
                            <TextBlock Text="{Binding LocalizedSelectedItemLabel}" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock Text="{Binding SelectedMenuItem.Name}" FontSize="16"/>
                            <TextBlock Text="{Binding SelectedMenuItem.Price, StringFormat='0.00\u20ba'}" Foreground="{StaticResource AccentBrush}" FontSize="16"/>
                            
                            <TextBlock Text="{Binding LocalizedQuantityLabel}" FontWeight="Bold" Margin="0,10,0,5"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="-" Width="30" Height="30" Margin="0,0,5,0" Style="{StaticResource SecondaryButtonStyle}" Click="DecrementQuantity"/>
                                <TextBlock Text="{Binding SelectedQuantity}" Width="50" TextAlignment="Center" VerticalAlignment="Center"/>
                                <Button Content="+" Width="30" Height="30" Style="{StaticResource SecondaryButtonStyle}" Click="IncrementQuantity"/>
                            </StackPanel>
                            
                            <Button Content="{Binding LocalizedAddToOrderButton}" Command="{Binding AddToOrderCommand}" 
                                    Style="{StaticResource DarkButtonStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Order Items -->
                    <TextBlock Text="{Binding LocalizedTableOrderLabel}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                    <ScrollViewer Height="300" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding CurrentOrderItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{StaticResource PrimaryBrush}" Padding="10" Margin="0,0,0,8" CornerRadius="3">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="{Binding MenuItem.Name}" FontWeight="Bold"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding DataContext.LocalizedQtyLabel, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" FontSize="11" Foreground="{StaticResource LightTextBrush}"/>
                                                    <TextBlock Text=": " FontSize="11" Foreground="{StaticResource LightTextBrush}"/>
                                                    <TextBlock Text="{Binding Quantity}" FontSize="11" Foreground="{StaticResource LightTextBrush}"/>
                                                </StackPanel>
                                                <ItemsControl ItemsSource="{Binding SelectedToppings}" FontSize="10">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Name, StringFormat='+ {0}'}" Foreground="{StaticResource AccentBrush}"/>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                                <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                                                    <TextBlock Text="{Binding DataContext.LocalizedTotalLabel, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                                                    <TextBlock Text=": " FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                                                    <TextBlock Text="{Binding Total, Converter={StaticResource OrderItemTotalConverter}}" 
                                                               FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <Button Grid.Column="1" Content="âœ•" 
                                                    Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}, Path=DataContext.RemoveFromOrderCommand}"
                                                    CommandParameter="{Binding .}"
                                                    Width="30" Height="30"
                                                    Style="{StaticResource SecondaryButtonStyle}"
                                                    Foreground="{StaticResource AccentBrush}"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <!-- Total and Actions -->
                    <Border Background="{StaticResource PrimaryBrush}" Padding="15" Margin="0,10,0,0" CornerRadius="8" BorderThickness="1" BorderBrush="{StaticResource BorderBrush}">
                        <StackPanel>
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{Binding LocalizedTotalLabel}" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" Text="{Binding CurrentOrderTotal}" 
                                          FontSize="28" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                            </Grid>
                            
                            <Button Content="{Binding LocalizedPrintButton}" Command="{Binding PrintOrderCommand}" 
                                    Style="{StaticResource DarkButtonStyle}" Margin="0,0,0,10" Height="45"/>
                            <Button Content="{Binding LocalizedPrintReceiptButton}" Command="{Binding PrintReceiptCommand}" 
                                    Style="{StaticResource DarkButtonStyle}" Margin="0,0,0,10" Height="45" Background="#FF8C00"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Button Content="{Binding LocalizedCheckoutCreditCard}" Command="{Binding CheckoutCreditCardCommand}" 
                                        Style="{StaticResource DarkButtonStyle}" Height="45" Background="#0066cc" Margin="0,0,5,0" />
                                <Button Content="{Binding LocalizedCheckoutCash}" Command="{Binding CheckoutCashCommand}" 
                                        Style="{StaticResource DarkButtonStyle}" Height="45" Background="#28a745"/>
                            </StackPanel>
                            <Button Content="{Binding LocalizedCancelButton}" Command="{Binding CancelCommand}" 
                                    Style="{StaticResource DarkButtonStyle}" Height="45" Background="#dc3545"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
